<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard Â· Virtual Test & Cert</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-950 text-slate-100">
  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside class="w-64 bg-slate-950 border-r border-slate-800 hidden md:flex flex-col">
      <div class="px-4 py-4 border-b border-slate-800 flex items-center gap-2">
        <div class="h-8 w-8 rounded-xl bg-indigo-500 flex items-center justify-center text-xs font-bold">
          VT
        </div>
        <div>
          <div class="text-sm font-semibold">Admin Panel</div>
          <div class="text-[10px] text-slate-400">Virtual Test & Certification</div>
        </div>
      </div>
      <nav class="flex-1 px-3 py-4 text-sm space-y-1">
        <button class="w-full text-left px-3 py-2 rounded-xl bg-slate-900">
          Colleges & Students
        </button>
        <button class="w-full text-left px-3 py-2 rounded-xl hover:bg-slate-900 text-slate-300">
          Certificates
        </button>
        <button class="w-full text-left px-3 py-2 rounded-xl hover:bg-slate-900 text-slate-300">
          Posts / Announcements
        </button>
      </nav>
      <div class="px-3 py-4 border-t border-slate-800 text-xs text-slate-400">
        Logged in as <span class="text-slate-200">admin@vtc.com</span>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col">
      <!-- Top Bar -->
      <header class="h-14 border-b border-slate-800 flex items-center justify-between px-4 bg-slate-950/80 backdrop-blur">
        <div>
          <div class="text-sm font-medium">Colleges & Students Overview</div>
          <div class="text-[11px] text-slate-400">
            Deadlines are set by college faculty. Access to the app depends on these dates.
          </div>
        </div>
        <div class="flex items-center gap-3 text-xs">
          <span class="hidden md:inline text-slate-400">Admin</span>
          <div class="h-8 w-8 rounded-full bg-slate-800 flex items-center justify-center text-[11px]">
            AD
          </div>
        </div>
      </header>

      <!-- Content -->
      <main class="flex-1 overflow-y-auto p-4 md:p-6 space-y-4">
        <!-- Summary Cards -->
        <section class="grid md:grid-cols-4 gap-3 text-xs">
          <div class="bg-slate-900 border border-slate-800 rounded-2xl p-3">
            <div class="text-slate-400 mb-1">Total Colleges</div>
            <div class="text-lg font-semibold" id="totalColleges">3</div>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-2xl p-3">
            <div class="text-slate-400 mb-1">Total Students</div>
            <div class="text-lg font-semibold" id="totalStudents">0</div>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-2xl p-3">
            <div class="text-slate-400 mb-1">Certificates Issued</div>
            <div class="text-lg font-semibold" id="totalCertificates">0</div>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-2xl p-3">
            <div class="text-slate-400 mb-1">Programs Locked</div>
            <div class="text-lg font-semibold" id="totalLocked">0</div>
          </div>
        </section>

        <!-- Colleges Table -->
        <section class="bg-slate-900 border border-slate-800 rounded-3xl p-4 md:p-5 text-xs md:text-sm">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-sm font-semibold">Colleges & Program Deadlines</h2>
            <div class="text-[11px] text-slate-400">
              Click a college to see its students and activity.
            </div>
          </div>
          <div class="border border-slate-800 rounded-2xl overflow-hidden">
            <table class="w-full text-left border-collapse">
              <thead class="bg-slate-950/70 text-[11px] uppercase tracking-wide text-slate-400">
                <tr>
                  <th class="py-2.5 px-3">College</th>
                  <th class="py-2.5 px-3">Program</th>
                  <th class="py-2.5 px-3">Deadline</th>
                  <th class="py-2.5 px-3">Students</th>
                  <th class="py-2.5 px-3">Status</th>
                  <th class="py-2.5 px-3">Actions</th>
                </tr>
              </thead>
              <tbody id="collegeTableBody" class="text-[11px] md:text-xs bg-slate-950/30">
                <!-- Filled by JS -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- Students & Activity -->
        <section class="grid md:grid-cols-3 gap-4">
          <!-- Students List -->
          <div class="md:col-span-2 bg-slate-900 border border-slate-800 rounded-3xl p-4 md:p-5 text-xs md:text-sm">
            <div class="flex items-center justify-between mb-3">
              <h2 class="text-sm font-semibold">
                Students in <span id="selectedCollegeName">Select a college</span>
              </h2>
              <span id="selectedCollegeDeadline" class="text-[11px] text-slate-400"></span>
            </div>
            <div class="border border-slate-800 rounded-2xl overflow-hidden">
              <table class="w-full text-left border-collapse">
                <thead class="bg-slate-950/70 text-[11px] uppercase tracking-wide text-slate-400">
                  <tr>
                    <th class="py-2.5 px-3">Student</th>
                    <th class="py-2.5 px-3">Access till</th>
                    <th class="py-2.5 px-3">Activity</th>
                    <th class="py-2.5 px-3">Certificate</th>
                    <th class="py-2.5 px-3">Program</th>
                    <th class="py-2.5 px-3">Actions</th>
                  </tr>
                </thead>
                <tbody id="studentTableBody" class="text-[11px] md:text-xs bg-slate-950/30">
                  <tr>
                    <td colspan="6" class="py-6 px-3 text-center text-slate-500">
                      Select a college in the table above to view students.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Activity Panel -->
          <div class="bg-slate-900 border border-slate-800 rounded-3xl p-4 md:p-5 text-xs md:text-sm">
            <div class="flex items-center justify-between mb-3">
              <h2 class="text-sm font-semibold">Recent Activity</h2>
              <span class="text-[11px] text-slate-400">Demo data</span>
            </div>
            <div id="activityList" class="space-y-2 text-[11px] md:text-xs">
              <!-- Filled by JS -->
            </div>
          </div>
        </section>
      </main>

      <!-- Toast Notification -->
      <div
        id="toast"
        class="fixed bottom-4 right-4 px-4 py-2 rounded-2xl bg-slate-900 border border-slate-700 text-xs text-slate-50 shadow-lg shadow-slate-900/60 opacity-0 pointer-events-none transition"
      >
        <span id="toastMessage">Action completed.</span>
      </div>
    </div>
  </div>

  <script>
    // Demo data (fake "database")
    const colleges = [
      {
        id: 1,
        name: "ABC Engineering College",
        program: "Python + Django Certification",
        deadline: "2025-12-31",
        status: "Active",
        locked: false,
        students: [
          {
            id: 101,
            name: "Rahul Sharma",
            accessTill: "2025-12-31",
            activity: "Completed 8/10 tests",
            certificateIssued: true,
            programStatus: "Completed",
          },
          {
            id: 102,
            name: "Ananya Verma",
            accessTill: "2025-12-31",
            activity: "Completed 5/10 tests",
            certificateIssued: false,
            programStatus: "In Progress",
          },
        ],
      },
      {
        id: 2,
        name: "XYZ Institute of Technology",
        program: "Full Stack Web Development",
        deadline: "2025-11-30",
        status: "Active",
        locked: false,
        students: [
          {
            id: 201,
            name: "Arjun Mehta",
            accessTill: "2025-11-30",
            activity: "Completed 10/10 tests",
            certificateIssued: true,
            programStatus: "Completed",
          },
          {
            id: 202,
            name: "Sara Khan",
            accessTill: "2025-11-30",
            activity: "Completed 2/10 tests",
            certificateIssued: false,
            programStatus: "In Progress",
          },
        ],
      },
      {
        id: 3,
        name: "City Professional College",
        program: "Aptitude & Soft Skills Program",
        deadline: "2025-10-15",
        status: "Expired",
        locked: true,
        students: [
          {
            id: 301,
            name: "Vikram Singh",
            accessTill: "2025-10-15",
            activity: "Completed 10/10 tests",
            certificateIssued: true,
            programStatus: "Locked",
          },
        ],
      },
    ];

    // Elements
    const collegeTableBody = document.getElementById("collegeTableBody");
    const studentTableBody = document.getElementById("studentTableBody");
    const selectedCollegeName = document.getElementById("selectedCollegeName");
    const selectedCollegeDeadline = document.getElementById("selectedCollegeDeadline");
    const activityList = document.getElementById("activityList");
    const toast = document.getElementById("toast");
    const toastMessage = document.getElementById("toastMessage");
    const totalCollegesEl = document.getElementById("totalColleges");
    const totalStudentsEl = document.getElementById("totalStudents");
    const totalCertificatesEl = document.getElementById("totalCertificates");
    const totalLockedEl = document.getElementById("totalLocked");

    let selectedCollegeId = null;

    // Render summary
    function renderSummary() {
      const totalColleges = colleges.length;
      const totalStudents = colleges.reduce((sum, c) => sum + c.students.length, 0);
      const totalCertificates = colleges.reduce(
        (sum, c) => sum + c.students.filter((s) => s.certificateIssued).length,
        0
      );
      const totalLocked = colleges.filter((c) => c.locked).length;

      totalCollegesEl.textContent = totalColleges;
      totalStudentsEl.textContent = totalStudents;
      totalCertificatesEl.textContent = totalCertificates;
      totalLockedEl.textContent = totalLocked;
    }

    // Render colleges table
    function renderColleges() {
      collegeTableBody.innerHTML = "";
      colleges.forEach((college) => {
        const row = document.createElement("tr");
        row.className = "border-t border-slate-800/80 hover:bg-slate-900/50 cursor-pointer";

        row.innerHTML = `
          <td class="py-2.5 px-3 align-top">
            <div class="font-medium text-[11px] md:text-xs">${college.name}</div>
          </td>
          <td class="py-2.5 px-3 align-top text-slate-300">
            ${college.program}
          </td>
          <td class="py-2.5 px-3 align-top">
            <span class="inline-flex items-center px-2 py-0.5 rounded-full bg-slate-900 border border-slate-700 text-[11px]">
              ${college.deadline}
            </span>
          </td>
          <td class="py-2.5 px-3 align-top">
            ${college.students.length}
          </td>
          <td class="py-2.5 px-3 align-top">
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${
              college.status === "Active"
                ? "bg-emerald-900/40 text-emerald-200 border border-emerald-700/60"
                : "bg-slate-900 text-slate-300 border border-slate-700"
            }">
              ${college.locked ? "Locked" : college.status}
            </span>
          </td>
          <td class="py-2.5 px-3 align-top">
            <div class="flex flex-wrap gap-1">
              <button
                class="px-2 py-1 rounded-full bg-slate-900 border border-slate-700 text-[11px] hover:border-slate-500"
                data-view-college="${college.id}"
              >
                View students
              </button>
              <button
                class="px-2 py-1 rounded-full bg-slate-900 border border-red-700 text-[11px] text-red-200 hover:bg-red-900/40"
                data-reset-college="${college.id}"
              >
                Reset program
              </button>
            </div>
          </td>
        `;

        collegeTableBody.appendChild(row);
      });
    }

    // Render students table for selected college
    function renderStudents(collegeId) {
      const college = colleges.find((c) => c.id === collegeId);
      if (!college) return;

      selectedCollegeId = collegeId;
      selectedCollegeName.textContent = college.name;
      selectedCollegeDeadline.textContent = `College deadline: ${college.deadline}`;

      studentTableBody.innerHTML = "";
      college.students.forEach((student) => {
        const row = document.createElement("tr");
        row.className = "border-t border-slate-800/80";

        row.innerHTML = `
          <td class="py-2.5 px-3 align-top">
            <div class="font-medium text-[11px] md:text-xs">${student.name}</div>
          </td>
          <td class="py-2.5 px-3 align-top">
            <span class="inline-flex items-center px-2 py-0.5 rounded-full bg-slate-900 border border-slate-700 text-[11px]">
              ${student.accessTill}
            </span>
          </td>
          <td class="py-2.5 px-3 align-top text-slate-300">
            ${student.activity}
          </td>
          <td class="py-2.5 px-3 align-top">
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${
              student.certificateIssued
                ? "bg-emerald-900/40 text-emerald-200 border border-emerald-700/60"
                : "bg-slate-900 text-slate-300 border border-slate-700"
            }">
              ${student.certificateIssued ? "Issued" : "Not issued"}
            </span>
          </td>
          <td class="py-2.5 px-3 align-top">
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${
              student.programStatus === "Completed"
                ? "bg-emerald-900/40 text-emerald-200 border border-emerald-700/60"
                : student.programStatus === "Locked"
                ? "bg-slate-900 text-slate-300 border border-slate-700"
                : "bg-indigo-900/40 text-indigo-200 border border-indigo-700/60"
            }">
              ${student.programStatus}
            </span>
          </td>
          <td class="py-2.5 px-3 align-top">
            <div class="flex flex-wrap gap-1">
              <button
                class="px-2 py-1 rounded-full bg-slate-900 border border-indigo-700 text-[11px] text-indigo-200 hover:bg-indigo-900/40"
                data-generate-cert="${student.id}"
              >
                Generate cert
              </button>
              <button
                class="px-2 py-1 rounded-full bg-slate-900 border border-red-700 text-[11px] text-red-200 hover:bg-red-900/40"
                data-reset-student="${student.id}"
              >
                Reset program
              </button>
            </div>
          </td>
        `;

        studentTableBody.appendChild(row);
      });

      renderActivity(college);
    }

    // Render activity panel
    function renderActivity(college) {
      activityList.innerHTML = "";
      const entries = [];

      college.students.forEach((s) => {
        entries.push({
          text: `${s.name} (${college.name}) - ${s.activity}`,
          type: s.certificateIssued ? "success" : "info",
        });
      });

      entries.forEach((entry) => {
        const div = document.createElement("div");
        div.className = "flex gap-2";
        div.innerHTML = `
          <div class="mt-[3px] h-1.5 w-1.5 rounded-full ${
            entry.type === "success" ? "bg-emerald-400" : "bg-indigo-400"
          }"></div>
          <div class="text-slate-200">${entry.text}</div>
        `;
        activityList.appendChild(div);
      });
    }

    // Toast
    function showToast(message) {
      toastMessage.textContent = message;
      toast.classList.remove("opacity-0", "pointer-events-none");
      setTimeout(() => {
        toast.classList.add("opacity-0", "pointer-events-none");
      }, 2000);
    }

    // Event delegation for colleges table
    collegeTableBody.addEventListener("click", (e) => {
      const viewBtn = e.target.closest("[data-view-college]");
      const resetBtn = e.target.closest("[data-reset-college]");

      if (viewBtn) {
        const collegeId = parseInt(viewBtn.dataset.viewCollege, 10);
        renderStudents(collegeId);
      }

      if (resetBtn) {
        const collegeId = parseInt(resetBtn.dataset.resetCollege, 10);
        const college = colleges.find((c) => c.id === collegeId);
        if (college) {
          college.locked = true;
          college.status = "Expired";
          college.students.forEach((s) => {
            s.programStatus = "Locked";
          });
          renderColleges();
          if (collegeId === selectedCollegeId) renderStudents(collegeId);
          renderSummary();
          showToast(`Program reset and locked for ${college.name}. Answers hidden; marks retained.`);
        }
      }
    });

    // Event delegation for students table
    studentTableBody.addEventListener("click", (e) => {
      const resetBtn = e.target.closest("[data-reset-student]");
      const certBtn = e.target.closest("[data-generate-cert]");

      if (!selectedCollegeId) return;

      const college = colleges.find((c) => c.id === selectedCollegeId);
      if (!college) return;

      if (resetBtn) {
        const studentId = parseInt(resetBtn.dataset.resetStudent, 10);
        const student = college.students.find((s) => s.id === studentId);
        if (student) {
          student.programStatus = "Locked";
          student.activity = "Program completed and reset. Must re-purchase for new access.";
          renderStudents(selectedCollegeId);
          showToast(`Program reset for ${student.name}.`);
        }
      }

      if (certBtn) {
        const studentId = parseInt(certBtn.dataset.generateCert, 10);
        const student = college.students.find((s) => s.id === studentId);
        if (student) {
          student.certificateIssued = true;
          student.programStatus = "Completed";
          renderStudents(selectedCollegeId);
          renderSummary();
          showToast(`Certificate generated for ${student.name}.`);
        }
      }
    });

    // Initial render
    renderSummary();
    renderColleges();
  </script>
</body>
</html>
